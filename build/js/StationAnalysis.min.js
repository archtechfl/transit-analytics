function StationRidershipWidget(e){this.pageSize=e}StationRidershipWidget.prototype.begin=function(){this.storage=[],this.makeDataRequest(),this.originalData},StationRidershipWidget.prototype.makeDataRequest=function(){var e,i,t,a;a=this,e=0,i=5e3,t="https://data.cityofchicago.org/resource/5neh-572f.json?$",a.retrieveLoop(t,i,e)},StationRidershipWidget.prototype.retrieveLoop=function(e,i,t){var a="&$where=date > '2014/01/01' AND date < '2014/12/31'",r=e+"limit="+i+"&$offset="+t+a,n=this,s=t;$.get(r,function(t){$.each(t,function(e,i){n.storage.push(i)}),5e3===t.length?(s+=5e3,n.retrieveLoop(e,i,s)):n.dataOrganizer(n.storage)})},StationRidershipWidget.prototype.dataOrganizer=function(e){var i={},t=[],a=[];$.each(e,function(e,t){var r=a.indexOf(t.station_id);if(-1===r){i[t.station_id]={},a.push(t.station_id),i[t.station_id].name=t.stationname;var n=parseInt(t.rides);i[t.station_id].rides=n}else{var n=parseInt(t.rides),s=parseInt(i[t.station_id].rides);i[t.station_id].rides=n+s}}),$.each(i,function(e,i){t.push(i)}),this.organizeTable(t)},StationRidershipWidget.prototype.organizeTable=function(e){var i,t,a,r;this.originalData=e,r=this.sortingRidership(e,"rides","descending");var n=new PaginationWidget("#table-1-ridership");n.begin(10),i=n.paginator(r),this.paginatedStorage=i,t=1,a=i.pages.length,this.renderNavigator(i.pages,t),renderRidership=new TableRenderer("ridershipTable","#ridershipTemplate",".ridershipTableContainer",".ridershipNavigation"),this.renderRidership=renderRidership,renderRidership.renderTable(i[t],t,a,1),this.onSort(),this.getPage(a)},StationRidershipWidget.prototype.sortingRidership=function(e,i,t){var a,r;return a=e,r=a.sort(function(e,a){return"rides"===i?"descending"===t?a.rides-e.rides:e.rides-a.rides:"descending"===t?a.name-e.name:e.name-a.name})},StationRidershipWidget.prototype.renderNavigator=function(e,i){var t,a,r;t={pages:e},a=$("#stationRidershipNavTemplate").html(),r=Mustache.render(a,t),$(".ridershipNavigation").html(r)},StationRidershipWidget.prototype.renderTable=function(e,i,t,a){var r,n,s,o,d,p,g;r=a,n={ridershipTable:e,count:function(){return function(e,i){return r++}},ridesWithSeparator:function(){var e=this.rides;return e=numeral(e).format("0,0")}},s=$("#ridershipTemplate").html(),o=Mustache.render(s,n),$(".ridershipTableContainer").html(o),d=".ridershipNavigation .page-"+i,$(d).addClass("active"),p=".ridershipNavigation .previous-nav",g=".ridershipNavigation .next-nav",1===i?($(p).addClass("disabled"),$(g).removeClass("disabled")):i===t?($(p).removeClass("disabled"),$(g).addClass("disabled")):($(p).removeClass("disabled"),$(g).removeClass("disabled"))},StationRidershipWidget.prototype.paginate=function(e){var i,t,a,r,n,s,o,d;i=e,t=e.length/this.pageSize,a={},d=[],r=0,n=this.pageSize;for(var p=0;t>=p;p++)s=e.slice(r,n),r+=this.pageSize,n+=this.pageSize,o=p+1,a[o]=s,d.push(o);return a.pages=d,a},StationRidershipWidget.prototype.onSort=function(){$(".station_listing_header").on("click",".sorting_header",function(e){console.log(e)})},StationRidershipWidget.prototype.getPage=function(e){var i,t,a,r,n;i=e,t=this,a=".ridershipNavigation .pagination-page-button",n=a+".active",r=n+" .page-number",$(".ridershipNavigation").on("click",".pagination-nav-button",function(e){e.preventDefault();var s,o,d,p,g,h,l,u;s=$(e.currentTarget).hasClass("pagination-end-button"),o=$(e.currentTarget).hasClass("active"),s||o?(isDisabled=$(e.currentTarget).hasClass("disabled"),isDisabled||(p=$(e.currentTarget).hasClass("previous-nav"),g=Number($(r).text()),$(n).removeClass("active"),h=p?g-1:g+1,l=(h-1)*t.pageSize+1,u=t.renderRidership,u.renderTable(t.paginatedStorage[h],h,i,l))):($(a+".active").removeClass("active"),d=Number($(e.currentTarget).find(".page-number").text()),l=(d-1)*t.pageSize+1,u=t.renderRidership,u.renderTable(t.paginatedStorage[d],d,i,l),t.onSort())})};